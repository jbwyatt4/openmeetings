<?xml version="1.0" encoding="UTF-8" ?>
<library>

<class name="bigTextListItem" extends="textlistitem" fontsize="12" />

 <class name="createpollwin" extends="labelexplorerbox" labelid="18"
    docking="true" resizeable="false" closable="false" width="500" x="100" y="220" height="240">
    
    <labeltext fontstyle="bold" labelid="19" y="22" />
    
    <labeltext labelid="20" y="42" />
    <edittext name="_question" multiline="true" width="390" x="100" y="42" height="60" />
     
        <netremotecallhib name="getPollTypeList" funcname="dokeosService.getPollTypeList"
            remotecontext="$once{ canvas.thishib }" > 
            <method name="setReferenceObj" args="obj">
                this.refObj = obj;
            </method>
            <handler name="ondata" args="value">
                <![CDATA[
                    //The onResult-Handler will be called be the rtmpconnection
                    Debug.write("getPollTypeList : ",value)
                    for (var i=0;i<value.length;i++){
                        this.parent._polltypes.addItem(canvas.getLabelName(value[i].pollTypeLabelid),value[i].pollTypesId);
                    }
                    this.parent._polltypes.selectItem(value[0].pollTypesId);
                ]]>
            </handler>   
        </netremotecallhib>        
    
    <labeltext labelid="21" y="122" />
    <combobox name="_polltypes" width="160" x="100" y="122" editable="false" itemclassname="bigTextListItem" >
    	<handler name="oninit">
    		<![CDATA[
    		    this.parent.getPollTypeList.setReferenceObj(this);
                this.parent.getPollTypeList.doCall();
    		]]>
    	</handler>
    </combobox>
     
     

    <simplelabelbutton labelid="25" width="200" x="80" y="218">
    	<handler name="onclick">
    		this.parent.close();
    	</handler>
    </simplelabelbutton>
    
    <simplelabelbutton labelid="22" width="200" x="290" y="218">
    	<handler name="onclick">
    		this.parent.createPoll.pollquestion = this.parent._question.getText();
    		this.parent.createPoll.polltypesid = this.parent._polltypes.getValue();
    		Debug.write("this.parent.createPoll.createPoll: ",this.parent.createPoll.createPoll);
    		this.parent.createPoll.doCall();
    		
    	</handler>
    </simplelabelbutton>
    
    <labeltext fgcolor="red" labelid="23" y="170" width="480" multiline="true" resize="false"/>
     
        <netremotecallhib name="createPoll" funcname="dokeosService.createPoll"
            remotecontext="$once{ canvas.thishib }" >
            <attribute name="pollquestion" value="" type="string" />
            <attribute name="polltypesid" value="0" type="number" />
            <netparam><method name="getValue">return parent.pollquestion;</method></netparam>
            <netparam><method name="getValue">return parent.polltypesid;</method></netparam>
            <handler name="ondata" args="value">
                <![CDATA[
                    //The onResult-Handler will be called be the rtmpconnection
                    Debug.write("createPoll : ",value);
                    this.parent.close();
                ]]>
            </handler>   
        </netremotecallhib>      
    
</class>


</library>