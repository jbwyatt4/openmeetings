<?xml version="1.0" encoding="UTF-8" ?>
<library>

<class name="conferenceboard" extends="basecontentview">	
	
	<labeltext fontstyle="bold" y="20" labelid="128" />
	
	<labeltext y="40" labelid="129" />
	
		<view y="60" x="20">
			<handler name="oninit">
    			this.getRoomsPublic.doCall();
    		</handler>
    		
		  	<netremotecallhib name="getRoomsPublic" funcname="conferenceservice.getRoomsPublic" remotecontext="$once{ canvas.thishib }" >   
		  		<netparam name="vars1"><method name="getValue">return canvas.sessionId;</method></netparam>  
		  		<netparam name="vars2"><method name="getValue">return 1;</method></netparam>  
		        <handler name="ondata" args="value">	
	                <![CDATA[
	                if (value!=null){
		                for(var eg=0;eg<value.length;eg++){
		                    Debug.write(value[eg]);
		                    var time = value[eg].starttime.getHours()+':'+value[eg].starttime.getMinutes()+' '+value[eg].starttime.getDate()+'.'+(value[eg].starttime.getMonth()+1)+'.'+value[eg].starttime.getFullYear();
		                    new roomlistItemPublic(parent.inn.inn.inn,{obj:value[eg],ispublic:true,roomid:value[eg].rooms_id,starttime:time,roomname:value[eg].name});
		                }
	                }
	                ]]>	        	          				
		        </handler>	
		  	</netremotecallhib>   
		  	
		  	<view width="480" height="200" name="inn"
		  		bgcolor="$once{ canvas.basebgcolorizer }" >
		  		<view x="1" y="1" width="478" height="198" name="inn" bgcolor="0xFFFFFF" clip="true" >
		  			<view layout="axis:y;spacing:2" name="inn" />
		  			<vscrollbar />
		  		</view>
		  	</view>
		</view>
		
		<view x="520" y="60" name="detailsarea" >
            <method name="opendetails">
                this.inn.animate('height',430, 1000, false);
            </method>
		  	<view clip="true" width="340" height="0" name="inn"
		  		bgcolor="$once{ canvas.basebgcolorizer }" >
		  		<view x="1" y="1" width="338" height="428" name="inn" bgcolor="0xFFFFFF" >
		  			<view layout="axis:y;spacing:2" name="inn" />
		  			<vscrollbar />
		  		</view>
                
		  	</view>
		</view>
		
	<labeltext y="270" labelid="130" />
		<view y="290" x="20">
			<handler name="oninit">
				Debug.write(hib.currentdomain);
				Debug.write(hib.currentdomainObj);
    			this.getRoomsByOrganisationAndType.doCall();
    		</handler>
    		
		  	<netremotecallhib name="getRoomsByOrganisationAndType" funcname="conferenceservice.getRoomsByOrganisationAndType" remotecontext="$once{ canvas.thishib }" >   
		  		<netparam name="vars1"><method name="getValue">return canvas.sessionId;</method></netparam>  
		  		<netparam name="vars2"><method name="getValue">return hib.currentdomainObj.organisation_id;</method></netparam>  
		  		<netparam name="vars3"><method name="getValue">return 1;</method></netparam>  
		        <handler name="ondata" args="value">	
	                <![CDATA[
	                if (value!=null){
		                for(var eg=0;eg<value.length;eg++){
		                    Debug.write("2: ",value[eg]);
		                    var time = value[eg].room.starttime.getHours()+':'+value[eg].room.starttime.getMinutes()+' '+value[eg].room.starttime.getDate()+'.'+(value[eg].room.starttime.getMonth()+1)+'.'+value[eg].room.starttime.getFullYear();
		                    new roomlistItemPublic(parent.inn.inn.inn,{obj:value[eg],ispublic:false,roomid:value[eg].room.rooms_id,starttime:time,roomname:value[eg].room.name});
		                }
	                }
	                ]]>	        	          				
		        </handler>	
		  	</netremotecallhib>   
		  	
		  	<view width="480" height="200" name="inn"
		  		bgcolor="$once{ canvas.basebgcolorizer }" >
		  		<view x="1" y="1" width="478" height="198" name="inn" bgcolor="0xFFFFFF" clip="true" >
		  			<view layout="axis:y;spacing:2" name="inn" />
		  			<vscrollbar />
		  		</view>
		  	</view>
		</view>
		
		
</class>

<class name="roomlistItemPublic" extends="view" bgcolor="0xFFFFFF"
    onmouseover="this.setBGColor(canvas.baseMouseOvercolorizer)"
    onmouseout="this.setBGColor(0xFFFFFF)" >

	<attribute name="ispublic" value="false" type="boolean" />
	<attribute name="obj" value="null" />
	<attribute name="roomid" value="0" type="number" />
	<attribute name="starttime" value="" type="string" />
	<attribute name="roomname" value="" type="string" />
	
	<labeltext resize="false" text="$once{ parent.roomname }" width="120" />
	<labeltext x="120" resize="false" text="$once{ parent.starttime }" width="180" />
	
	<handler name="onclick">
		Debug.write("this. ",this.obj,this.parent.parent.parent.parent.parent);
        parent.parent.parent.parent.parent.detailsarea.opendetails();
	</handler>
	
	<simplelabelbutton labelid="131" x="300" width="160">
		<handler name="onclick">
            if (this.parent.ispublic){
                hib.connectedroom=parent.obj.name+parent.obj.rooms_id;
                hib.conferencedomain="public";
                Debug.write("ispublic");
            } else {
                hib.connectedroom=parent.obj.room.name+parent.obj.room.rooms_id;
                hib.conferencedomain = parent.obj.organisation.name;
                Debug.write("non ispublic");
            }
            Debug.write("hib.conferencedomain: ",hib.conferencedomain);
            clearStageContent();
            canvas._mainbgcontentNavi.navi._innercontent.clearAllSubItemLists();  
            new conference(canvas.main_content._content);          
        </handler>
	</simplelabelbutton>
	
</class>

<class name="conferencedetailsarea" extends="view">


</class>


</library>